<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mermaid Diagram Test</title>

    <!-- Mermaid.js CDN -->
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });

      // JSON 형식의 데이터를 받을 부분
      const jsonResponse = {
        status: 'success',
        data: {
          diagram:
            '```mermaid\nsequenceDiagram\n    participant User\n    participant System\n    participant Database\n\n    User->>System: 회원가입 요청 (아이디, 비밀번호, 이메일)\n    System->>Database: 계정 정보 저장 요청\n    Database-->>System: 계정 생성 결과\n    System-->>User: 회원가입 성공 메시지\n\n    User->>System: 로그인 요청 (아이디, 비밀번호)\n    System->>Database: 사용자 정보 조회 요청\n    Database-->>System: 사용자 정보\n    System-->>User: 로그인 성공 및 토큰 발급\n\n    User->>System: 게시글 작성 요청 (제목, 내용)\n    System->>Database: 게시글 저장 요청\n    Database-->>System: 게시글 ID 및 작성 시간\n    System-->>User: 게시글 작성 성공 메시지\n\n    User->>System: 게시글 목록 조회 요청\n    System->>Database: 게시글 목록 조회 요청\n    Database-->>System: 게시글 목록\n    System-->>User: 게시글 목록 표시\n\n    User->>System: 특정 게시글 상세 조회 요청 (게시글 ID)\n    System->>Database: 게시글 상세 정보 조회 요청\n    Database-->>System: 게시글 상세 정보\n    System-->>User: 게시글 상세 정보 표시\n\n    User->>System: 게시글 수정 요청 (게시글 ID, 수정 내용)\n    System->>Database: 게시글 수정 요청\n    Database-->>System: 수정 결과\n    System-->>User: 게시글 수정 성공 메시지\n\n    User->>System: 게시글 삭제 요청 (게시글 ID)\n    System->>Database: 게시글 삭제 요청\n    Database-->>System: 삭제 결과\n    System-->>User: 게시글 삭제 성공 메시지\n\n    User->>System: 댓글 작성 요청 (게시글 ID, 댓글 내용)\n    System->>Database: 댓글 저장 요청\n    Database-->>System: 댓글 ID 및 작성 시간\n    System-->>User: 댓글 작성 성공 메시지\n\n    User->>System: 댓글 수정 요청 (댓글 ID, 수정 내용)\n    System->>Database: 댓글 수정 요청\n    Database-->>System: 수정 결과\n    System-->>User: 댓글 수정 성공 메시지\n\n    User->>System: 댓글 삭제 요청 (댓글 ID)\n    System->>Database: 댓글 삭제 요청\n    Database-->>System: 삭제 결과\n    System-->>User: 댓글 삭제 성공 메시지\n\n    User->>System: 게시글 검색 요청 (검색어)\n    System->>Database: 게시글 검색 요청\n    Database-->>System: 검색 결과 목록\n    System-->>User: 검색 결과 표시\n```',
        },
      };

      // JSON 응답에서 mermaid 코드만 추출하여 HTML에 삽입
      window.onload = function () {
        const diagramCode = jsonResponse.data.diagram; // Mermaid 다이어그램 코드 추출

        // Mermaid 코드에서 "```mermaid\n"과 "```"를 제거하고, 줄바꿈을 유지
        const cleanDiagramCode = diagramCode
          .replace(/```mermaid\n|```/g, '')
          .trim();

        // 다이어그램 코드로 Mermaid div 생성
        const diagramContainer = document.getElementById('mermaid-container');
        diagramContainer.innerHTML = `<div class="mermaid">${cleanDiagramCode}</div>`;

        // Mermaid.js 코드 렌더링
        mermaid.contentLoaded();
      };
    </script>
  </head>
  <body>
    <h1>Mermaid.js 다이어그램 테스트</h1>

    <!-- 다이어그램을 렌더링할 영역 -->
    <div id="mermaid-container"></div>
  </body>
</html>
